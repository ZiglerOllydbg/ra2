# 第二里程碑详细系统设计

## 🔄 游戏循环系统

### 核心循环流程
```
游戏开始
    ↓
初始资源分配 (1000资金 + 3坦克)
    ↓
经济阶段 → 建造阶段 → 生产阶段 → 战斗阶段
    ↑                                  ↓
    └────────── 资源回收 ────────────┘
```

### 阶段详细说明

#### 1. 经济阶段
**资源采集机制**
- **资金收入**：
  - 基础收入：每5秒 +50资金（来自初始采矿场）
  - 额外收入：每个采矿场每5秒 +50资金
  - 显示：实时资金计数器 + 收入飘字

**电力管理**
```
电力供应 = 主营地(10) + 发电厂数量 × 10
电力需求 = 坦克工厂数量 × 5
电力状态：
- 充足：需求 ≤ 供应（绿色显示）
- 紧张：需求 = 供应（黄色显示）
- 不足：需求 > 供应（红色显示，无法新建建筑）
```

#### 2. 建造阶段
**建造规则**
- **序列建造**：一次只能建造一个建筑
- **位置限制**：
  - 采矿场：必须建在资源点上
  - 其他建筑：需要平坦地形，不能与其他建筑重叠
- **建造时间**：实时进度条显示

**建造队列**
```
[正在建造：发电厂] ████████░░ 80%
[等待队列：采矿场] [坦克工厂]
```

#### 3. 生产阶段
**坦克生产机制**
- **队列生产**：最多同时生产3辆坦克
- **进度显示**：每个生产槽独立进度条
- **产出位置**：坦克工厂正前方生成区域

**生产限制**
- 需要足够资金（300/辆）
- 需要空闲电力（5/工厂）
- 生产槽位有空余

#### 4. 战斗阶段
**自动战斗流程**
```
单位移动 → 进入攻击范围 → 自动索敌 → 攻击循环
    ↓
目标死亡 → 重新索敌
    ↓
所有敌方单位死亡 → 攻击建筑
```

## 🏗️ 建筑系统详细设计

### 建筑属性表

#### 主营地
```
生命值：1000
电力提供：10
建造时间：无法建造（初始）
功能：
- 游戏核心，被毁即失败
- 提供初始电力
- 可建造其他基础建筑
视觉特征：最大、最显眼的建筑
```

#### 发电厂
```
造价：500资金
建造时间：15秒
电力提供：10
生命值：400
功能：增加电力供应
视觉特征：带有旋转部件的工业建筑
```

#### 采矿场
```
造价：800资金  
建造时间：20秒
电力消耗：0
生命值：400
功能：
- 必须建在资源点上
- 每5秒产生50资金
- 资源点枯竭后停止工作
视觉特征：带有采集臂的建筑，资源点上有发光特效
```

#### 坦克工厂
```
造价：1000资金
建造时间：25秒
电力消耗：5
生命值：500
功能：
- 生产坦克单位
- 最多3个生产队列
- 每个队列独立进度
视觉特征：大型工厂建筑，有生产动画
```

### 建筑交互规则

#### 建造依赖
```
主营地
    ↓
发电厂 → 采矿场
    ↓
坦克工厂
```

#### 建筑状态
- **建造中**：半透明模型，进度条显示
- **正常运行**：完整模型，功能正常
- **受损**（<50%生命值）：冒烟特效
- **摧毁**：爆炸特效，变成废墟模型

## ⚔️ 战斗系统详细设计

### 单位属性表

#### 基础坦克
```
造价：300资金
生产时间：20秒
生命值：100
攻击力：10
攻击速度：1次/秒
攻击范围：5单位
移动速度：3单位/秒
索敌范围：8单位
```

### 战斗机制

#### 自动攻击规则
```
索敌优先级：
1. 最近的可攻击单位
2. 生命值最低的单位  
3. 攻击本方单位的敌人

攻击流程：
- 进入攻击范围后停止移动
- 转向面对目标
- 按攻击速度循环攻击
- 目标死亡后重新索敌
```

#### 伤害计算
```
简单伤害公式：
实际伤害 = 攻击力 - 0（无护甲系统）

死亡判定：
当前生命值 ≤ 0 时单位死亡
```

#### 移动与战斗
- **移动中**：不攻击，专心移动至目标点
- **攻击移动**：移动中遇到敌人立即攻击
- **站定攻击**：进入范围后停止移动专注攻击

### 胜负判定系统

#### 主要胜利条件
```
摧毁所有敌方主营地
```

#### 次要胜利条件（备用）
```
时间结束：
- 10分钟时限
- 剩余生命值比例高者胜
```

#### 实时判定
```
每帧检查：
- 各方主营地是否存活
- 游戏是否超时
- 玩家是否主动投降
```

## 📊 数值平衡设计

### 经济数值表

#### 收入平衡
```
初始资金：1000
采矿场收入：50资金/5秒
回本时间：
- 发电厂：无直接收入（间接支持）
- 采矿场：800 ÷ (50/5) = 80秒
- 坦克工厂：通过坦克生产间接回本
```

#### 建造时间平衡
```
发电厂：15秒
采矿场：20秒  
坦克工厂：25秒
坦克：20秒

设计理念：军事建筑时间 > 经济建筑时间
```

### 战斗数值表

#### 坦克对战
```
1v1 对决：
100生命值 ÷ 10伤害/秒 = 10秒击杀时间
相互攻击：同时死亡

多坦克战斗：
数量优势方有显著优势
```

#### 建筑防御
```
主营地：1000生命值
- 需要1辆坦克攻击：100秒
- 需要5辆坦克攻击：20秒
- 需要10辆坦克攻击：10秒

其他建筑：400-500生命值
- 更容易被快速摧毁
```

### 时间节奏控制

#### 标准游戏进程
```
阶段1：经济建设（0-2分钟）
- 建造发电厂（15秒）
- 建造采矿场（20秒）
- 等待资金积累（约30秒）

阶段2：军事建设（2-4分钟）  
- 建造坦克工厂（25秒）
- 开始坦克生产（20秒/辆）

阶段3：战斗阶段（4分钟+）
- 小规模冲突
- 主力决战
- 基地攻击
```

#### 平衡目标
- **平均游戏时间**：5-8分钟
- **最短游戏时间**：3分钟（快速rush）
- **最长游戏时间**：10分钟（僵持战）

## 🎮 玩家体验设计

### 新手友好提示
```
经济提示：
- "电力不足，建造发电厂吧！"
- "资金增长太慢，考虑建造第二个采矿场"

军事提示：
- "坦克数量不足，敌方可能进攻"
- "可以尝试攻击敌方采矿场削弱经济"
```

### 视觉反馈系统
```
建造反馈：绿色/红色高亮
战斗反馈：伤害数字飘出
经济反馈：资金增加飘字
状态反馈：电力不足红色闪烁
```

这个详细系统设计确保了游戏循环的流畅性、建筑系统的深度和战斗系统的可玩性，所有数值都经过精心平衡，为玩家提供紧张刺激的RTS体验。