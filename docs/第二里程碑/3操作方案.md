****# 手机端操作方案设计

## 📱 核心设计原则
- **触屏友好**：避免复杂手势，操作直观简单
- **界面简洁**：重要信息清晰，按钮大小适中
- **操作流畅**：减少操作步骤，提升响应速度

---

## 🏗️ 建造操作方案

### 1. 建造入口
```
[屏幕右下角固定建造按钮]
点击后弹出建筑菜单：
[发电厂] [采矿场] [坦克工厂]
```

### 2. 建筑放置流程
1. **选择建筑**：点击建筑图标
2. **预览放置**：
   - 半透明建筑模型跟随手指
   - 绿色=可建造，红色=不可建造
   - 自动吸附到网格或合适位置
3. **确认建造**：
   - **确认按钮**：在屏幕底部中央显示一个绿色的“✅”按钮，点击即可确认建造。
   - **双击放置**：也可以直接在地图上双击以确认放置。
4. **取消建造**：
   - **取消按钮**：在屏幕底部中央显示一个红色的“❌”按钮，点击即可取消建造。
   - **点击空白处**：点击屏幕上的任意空白区域也可以取消当前的建造操作。

### 3. 建造限制提示
- **资金不足**：图标变灰，显示所需资金
- **电力不足**：显示当前电力/所需电力
- **位置无效**：红色高亮，提示原因（如：需要资源点）

### 按钮显示逻辑
- **进入预览状态时**：当用户点击建筑图标并进入预览放置状态时，屏幕底部中央会显示绿色的"✅"确认按钮和红色的"❌"取消按钮。
- **退出预镜状态时**：一旦用户完成建造（通过点击确认按钮、双击放置）或取消建造（通过点击取消按钮、点击屏幕空白处），这两个按钮将立即消失。

---

## 🎯 单位选择方案

### 多选操作
#### 方案：框选（推荐）
```
[左下角固定"选择模式"按钮]
点击切换：移动模式 / 选择模式

选择模式下：
- 单指拖动绘制选择框
- 松开后选中框内所有单位
- 选择框半透明蓝色显示
```

#### 详细操作步骤：
1. **切换至选择模式**
   - 在左下角找到"选择模式"按钮
   - 点击按钮切换当前操作模式
   - 按钮状态会从"移动模式"变为"选择模式"

2. **开始框选操作**
   - 将一根手指放在屏幕上想要开始框选的位置
   - 按住并拖动手指来绘制选择框
   - 选择框将以半透明蓝色显示，便于识别框选范围

3. **完成框选**
   - 继续拖动手指直到框选范围覆盖想要选择的所有单位
   - 松开手指完成框选操作
   - 系统会自动选中框内的所有单位

4. **选中结果反馈**
   - 被选中的单位会有明显标识（例如高亮边框或特殊标记）
   - 屏幕底部状态栏会显示当前选中的单位数量和信息


### 3. 选择组管理
```
[屏幕底部选择组快捷栏]
[1] [2] [3] [4]
长按单位组 → 分配到数字键
点击数字键 → 快速选择该组
```

#### 详细操作步骤：

1. **创建选择组**
   - 首先通过框选或其他方式选中一组单位
   - 在屏幕底部找到选择组快捷栏中的数字键（[1] [2] [3] [4]）
   - 长按其中一个数字键（例如[1]）
   - 系统会将当前选中的单位分配到该数字键

2. **使用选择组**
   - 直接点击已分配的选择组数字键（例如[1]）
   - 系统会立即选中之前分配给该数字键的所有单位
   - 可以随时重复此操作来快速切换不同的单位组

3. **重新分配选择组**
   - 选中新的单位组合
   - 长按同一个数字键
   - 系统会用新选中的单位替换原来分配给该数字键的单位

---

## 🚀 移动操作方案

### 1. 基础移动
#### 详细操作步骤：
1. **选择要移动的单位**
   - 使用框选方式选择单位，或
   - 点击选择单个单位，或
   - 通过选择组快捷键快速选择已编组的单位

2. **执行移动指令**
   - 确保当前处于"移动模式"（左下角按钮显示为移动模式）
   - 在地图上点击目标位置
   - **目标超出视口时**：
     - **小地图定位**：点击左上角小地图上的目标位置，视角立即跳转
     - **小地图拖动**：按住小地图并拖动，视角会随手指移动而缓慢平移
       - 拖动速度与手指速度成正比
       - 松开手指后视角停止移动
       - 适用于需要精细调整视角的场景
     - **自动跟随**：当点击位置超出当前视口边缘30像素时，视角平滑跟随
   - 被选中的单位将开始向目标位置移动

3. **移动反馈**
   - 移动路径会以绿色箭头线显示
   - 单位会沿着路径前进，避开障碍物
   - 到达目标位置后，单位会停止并进入待命状态

### 2. 攻击移动

单位拥有自动攻击能力，当单位在移动过程中遇到敌人时会自动进行攻击，但依然会继续朝着目标位置移动。到达目标位置后，如果附近还有敌人目标，则会继续追击攻击。

---

## 📐 界面布局设计

### 操作热力图分析
```
高频操作区域分布：
- 建造按钮：右下角 15% 屏幕区域（直径80px圆形）
- 选择模式：左下角 10% 屏幕区域（直径60px圆形）
- 移动指令：主视角区域 65% 屏幕区域（中央大区域）
- 状态栏：底部 10% 屏幕区域（全宽度长条）

操作密度分布：
- 建造/选择：每分钟3-5次（低频）
- 移动指令：每分钟15-20次（高频）
- 状态查看：持续性（中频）
```

### 屏幕分区
```
┌─────────────────┬─────┐
│    小地图       │资源 │
│                 │信息 │
├─────────────────┼─────┤
│                 │     │
│    游戏主视角    │     │
│                 │     │
├─────────────────┴─────┤
│        操作区         │
└───────────────────────┘
```

### 具体布局
#### 左上角：信息区
- 小地图（可点击快速移动视角）
- 资源显示：
  - 资金：实时显示当前资金数量
  - 电力：绿色=充足，黄色=紧张，红色=不足

#### 底部：操作区
```
[建造] [生产] [设置] [选择模式]

选中单位时：
[移动] [停止]
```

#### 状态栏详细说明（非必要，可延迟实现）

**位置**：屏幕底部固定区域，始终可见

**组成部分**：

1. **选中单位信息区**
   - **单位头像**：显示当前选中的单位类型图标（如坦克图标）
   - **血量条**：绿色进度条显示当前生命值，红色表示受损（多选显示当前总血量与总生命值百分比）
   - **数量显示**：当选择多个单位时，显示"x4"等数量标识
   - **交互提示**：选中单位时，该区域会轻微放大并高亮

2. **建造队列显示**
   - **格式**：[建筑名称] ████████░░ 80%
   - **进度条**：绿色实心部分表示已完成，空白部分表示剩余
   - **交互功能**：
     - 点击队列项可查看详细建造信息
     - 长按队列项可取消建造任务
   - **状态提示**：
     - 正常：绿色进度条
     - 电力不足：黄色闪烁进度条
     - 资金不足：红色进度条

3. **生产队列显示**
   - **格式**：[单位名称] ████░░░░░ 40%
   - **生产槽位**：最多显示3个并行生产任务
   - **交互功能**：
     - 点击可查看生产详情
     - 长按可取消生产任务
   - **状态提示**：
     - 正常：绿色进度条
     - 电力不足：黄色闪烁
     - 生产槽满：显示"[满]"标识

**状态栏交互逻辑**：
- **经济阶段**：当电力紧张时，状态栏会整体轻微闪烁黄色
- **建造阶段**：点击建造队列可快速跳转到对应建筑位置
- **生产阶段**：生产完成时会有短暂的绿色光效提示
- **战斗阶段**：当单位受损时，对应头像会有红色边框闪烁

## **设计原则**：
- 保持信息简洁，避免过度拥挤
- 关键状态使用颜色编码（绿/黄/红）
- 交互反馈即时可见
- 重要变化有视觉提示但不干扰游戏主视角

## 交互逻辑
1. **经济阶段**：
   - 资源信息区突出显示电力状态
   - 建造按钮高亮提示建造发电厂

2. **建造阶段**：
   - 点击[建造]按钮弹出建筑菜单
   - 选择建筑后进入预览放置状态
   - 屏幕底部显示确认/取消按钮

3. **生产阶段**：
   - 点击[生产]按钮进入生产界面
   - 显示可用生产队列和当前进度
   - 可添加/取消生产任务

4. **战斗阶段**：
   - 选中单位后显示[移动][停止]操作
   - 移动路径以绿色箭头线显示
   - 自动攻击无需额外操作

---


## ✋ 手势操作优化

### 视角控制
#### 详细操作说明：
1. **触发条件**
   - 在游戏主视角区域（非UI区域）进行操作
   - 未处于选择模式（左下角按钮显示为移动模式）
   - 未选中任何单位

2. **操作步骤**
   - 将单指放在游戏主视角区域内
   - 按住并拖动手指（移动距离超过10像素触发）
   - 摄像机会随手指移动方向平滑移动
   - 松开手指后摄像机停止移动

3. **防冲突机制**
   - **与点击操作区分**：
     - 短按（<200ms且移动<10像素）：视为点击，可能选择单位
     - 长拖（>200ms或移动>10像素）：视为视角拖动

### 防误触机制
- **双击 vs 单击**：检测点击间隔<300ms且位移<5px判定为双击
- **拖动 vs 点击**：位移>10px触发拖动，否则触发点击
- **视角拖动优先级**：仅在未选中单位且未处于建造预览时生效
   - **与框选操作区分**：
     - 必须先切换到选择模式才能进行框选
     - 视角控制仅在移动模式下有效
   - **与单位移动区分**：
     - 选中单位后，点击地面会触发移动命令
     - 视角控制需要在未选中单位时操作

4. **视觉反馈**
   - 摄像机移动时，屏幕边缘有轻微模糊效果
   - 移动速度与手指速度成正比
   - 到达地图边界时有弹性缓冲效果


---

## 📱 设备适配考虑

### 屏幕比例
- 16:9、18:9、19.5:9等全面屏适配
- 刘海屏、水滴屏安全区域

### 性能优化
- 触控事件合并处理
- 选择渲染使用GPU Instancing
- 移动预测和路径平滑

这个操作方案专门为手机触屏设计，既保持了RTS的操作深度，又充分考虑了移动端的操作习惯。需要我详细说明某个特定操作的代码实现吗？