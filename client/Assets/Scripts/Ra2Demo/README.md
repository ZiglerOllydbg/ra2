# RA2 客户端 Demo

这是一个基于Unity的RTS游戏客户端演示项目，实现了单位选择、移动、网络对战等核心功能。

## 功能特性

### 1. 单位选择系统
- **智能选择模式**：系统会自动判断点击位置，无需按Shift键
  - 点击单位：直接选择该单位
  - 点击空白区域并拖拽：进入框选模式
- **多选支持**：
  - 按住Ctrl键并点击单位：追加选择/取消选择单位
  - 在空白区域拖拽鼠标：框选区域内的所有单位
  - 按住Ctrl键并拖拽：追加框选（保留原有选择）
- **拖拽阈值**：设置了5像素的拖拽阈值，避免轻微移动误触发框选

### 2. 单位控制
- **移动命令**：右键点击地面，选中的单位会移动到目标位置
- **单位状态显示**：在场景视图中以不同颜色显示选中单位和移动目标

### 3. 网络对战
- **服务器连接**：支持连接远程服务器和本地测试服务器
- **房间系统**：支持多种房间类型（单人、双人、三人、四人、八人）
- **匹配系统**：自动匹配对手并初始化游戏世界

### 4. 小地图系统
- **实时显示**：显示整个战场的俯视图
- **相机指示器**：在小地图上显示当前相机视角位置
- **交互支持**：点击小地图可快速移动相机到对应位置

### 5. UI界面
- **房间选择**：游戏开始前可选择房间类型
- **本地服务器选项**：可切换连接本地或远程服务器
- **匹配按钮**：居中显示的匹配按钮
- **游戏控制**：游戏开始后提供暂停/继续功能
- **选中信息**：显示当前选中单位数量

## 使用方法

### 游戏流程
1. 启动游戏后，在左上角选择房间类型
2. 如需本地测试，勾选"使用本地服务器"
3. 点击屏幕中央的"匹配"按钮开始匹配
4. 匹配成功后游戏自动开始

### 单位操作
- **选择单位**：
  - 单击单位：选择单个单位
  - Ctrl + 单击：追加选择/取消选择单位
  - 拖拽框选：选择区域内的所有单位
  - Ctrl + 拖拽：追加框选单位
- **移动单位**：选中单位后，右键点击目标位置

### 相机控制
- **小地图导航**：点击小地图任意位置，相机将移动到对应位置
- **自动定位**：游戏开始时相机会自动定位到我方工厂位置

## 技术实现

### 核心组件
- `Ra2Demo.cs`：主控制脚本，处理游戏逻辑、单位选择、网络通信等
- `GameWorldBridge`：游戏世界桥接器，连接逻辑层和视图层
- `WebSocketNetworkAdaptor`：WebSocket网络适配器，处理网络通信
- `MiniMapController`：小地图控制器，管理小地图渲染和交互

### 依赖库
- Unity Input System：处理用户输入
- ZLockstep：帧同步框架
- WebSocket：网络通信

## 配置选项

### 服务器设置
- **远程服务器**：`ws://101.126.136.178:8080/ws`
- **本地服务器**：`ws://127.0.0.1:8080/ws`

### 持久化设置
- 房间类型选择会保存到PlayerPrefs中
- 本地服务器选项会保存到PlayerPrefs中

## 开发说明

### 框选功能实现要点
1. 坐标系统统一：确保框选区域计算和单位位置检测使用相同的坐标系统
2. 智能判断：根据点击位置自动判断是单选还是框选
3. 拖拽阈值：避免轻微移动误触发框选
4. 可视化反馈：实时显示框选区域

### 小地图实现要点
1. 独立控制器：通过MiniMapController脚本管理小地图相机和渲染纹理
2. 坐标映射：正确处理小地图纹理坐标与游戏世界坐标的转换
3. 交互反馈：提供相机视角指示器和点击导航功能